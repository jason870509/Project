<!DOCTYPE html>

<html>

<head>
    <style>
        #info {
            position: absolute;
            top: 0px;
            width: 100%;
            padding: 10px;
            text-align: center;
            color: #ffff00
        }

        body {
            overflow: hidden;
        }
    </style>
</head>

<body>

    <div id="info">Dancing Man<br>
        <button id="play" style="width:10%">Dance</button><br>
        <select name="dance" id="dance">
            <option value="dance5">Please select dance</option>
            <option value="walk">walk</option>
            <option value="walk2">walk-2</option>
            <option value="jump">jump</option>
            <option value="dance1">dance-1</option>
            <option value="dance3">dance-2</option>
            <option value="dance4">dance-3</option>
            <option value="dance5">dance-4</option>
            <option value="dance6">dance-4</option>
        </select>
    </div>
    <script src="./json/getJson.js"></script>
    <script src="./js/three.js"></script>
    <script src="./js/OrbitControls.js"></script>
    <script src="./js/dat.gui.min.js"></script>
    <script src="./js/KeyboardState.js"></script>
    <script src="./js/jquery-2.1.4.min.js"></script>
    <script src="./json/dance.json"></script>

    </audio>

    <script src="buildModel.js"></script>
    <script src="save_angle.js"></script>
    <script src="./dance/walk.js"></script>
    <script src="./dance/jump.js"></script>
    <!-- <script src="./dance/dance-1.js"></script>
    <script src="./dance/dance-3.js"></script>
    <script src="./dance/dance-4.js"></script>
    <script src="./dance/walk2.js"></script>

    <script src="./dance/dance-6.js"></script>
    <script src="./dance/dance-5.js"></script> -->
    <script src="./Walking Simulator/js/ccdbox.js"></script>
    <script>

        var joint = [];
        var jointP = new THREE.Vector3();
        var jsIndex = 0;
        init();
        animate();

        function init() {
            scene = new THREE.Scene();

            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 10000);
            camera.position.y = 200;
            camera.position.z = 1000;

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x888888);

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            document.body.appendChild(renderer.domElement);

            light = new THREE.PointLight(0x888888);
            light.position.set(0, 300, 0);
            scene.add(light);

            var amblight = new THREE.AmbientLight(0x444444); // soft white light
            scene.add(amblight);

            var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
            //scene.add(gridXZ);
            gridXZ.position.y = -50
            //////////////////////////////////////////////////////////////////////////////
            var floor = new THREE.Mesh(new THREE.PlaneGeometry(10000, 10000), new THREE.MeshPhongMaterial({ color: 0x888888, side: THREE.DoubleSide }));
            floor.rotation.x = Math.PI / 2;
            scene.add(floor);

            var plane = new THREE.Mesh(new THREE.PlaneGeometry(640, 480), new THREE.MeshPhongMaterial({ color: 0x888888, side: THREE.DoubleSide }))
            plane.position.y = 240
            // scene.add(plane);

            // for (i = 0; i < 33; i++) {
            //     joint[i] = new THREE.Mesh(new THREE.SphereGeometry(10), new THREE.MeshPhongMaterial({ color: 0xff00ff }))
            //     joint[i].position.copy();
            //     scene.add(joint[i]);
            // }
            setTimeout(1000)
            console.log('x' + (1 + 1))
            for (i = 0; i < 33; i++) {
                x = parseFloat(jsonData[0]['x' + (i + 1)]) * 640 - 640 / 2;
                y = 480 - parseFloat(jsonData[0]['y' + (i + 1)]) * 480;
                z = parseFloat(jsonData[0]['z' + (i + 1)]) * 50;
                jointP = new THREE.Vector3(x, y, z);
                joint[i] = new THREE.Mesh(new THREE.SphereGeometry(8), new THREE.MeshPhongMaterial({ color: 0xff00ff }))
                joint[i].position.copy(jointP);
                scene.add(joint[i]);
            }


        }




        function animate() {
            jsIndex += 1;
            if (jsIndex > 135)
                jsIndex = 0;
            console.log(jsIndex)
            for (i = 0; i < 33; i++) {
                x = parseFloat(jsonData[jsIndex]['x' + (i + 1)]) * 640 - 640 / 2;
                y = 480 - parseFloat(jsonData[jsIndex]['y' + (i + 1)]) * 480;
                z = parseFloat(jsonData[0]['z' + (i + 1)]) * 100;
                jointP = new THREE.Vector3(x, y, z);
                joint[i].position.copy(jointP);
            }


            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

    </script>
</body>

</html>